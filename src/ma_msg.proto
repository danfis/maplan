message PlanMAMsgPublicState {
    required int32 agent_id = 1;
    required bytes state = 2;
    required int32 state_id = 3;
    required int32 cost = 4;
    required int32 heuristic = 5;
}

message PlanMAMsgHeurRequest {
    // Source agent
    required int32 agent_id = 1;
    // State from which to find heuristic value
    repeated int32 state = 3;
    // Global operator ID
    required int32 op_id = 4;
}

message PlanMAMsgHeurResponseOp {
    required int32 op_id = 1;
    optional int32 cost = 2;
    optional int32 owner = 3;
}

message PlanMAMsgHeurResponse {
    // Operator for which this is response
    required int32 op_id = 1;
    // List of operators in relaxed plan
    repeated PlanMAMsgHeurResponseOp op = 2;
    // List of operators in relaxed plan that belong to other peers
    repeated PlanMAMsgHeurResponseOp peer_op = 3;
}

message PlanMAMsgPathOperator {
    // Name of the operator
    required string name = 1;
    // Cost of the operator
    required int32 cost = 2;
}

message PlanMAMsgTracePath {
    // The agent who started the trace path operation
    required int32 origin_agent_id = 1;
    // State from which the back tracing should start
    required int32 state_id = 2;
    // The path traced so far
    repeated PlanMAMsgPathOperator path = 3;
    // True if the tracing is done
    required bool done = 4;
}

message PlanMAMsgSolution {
    // Public state the is a solution
    required PlanMAMsgPublicState state = 1;
    // Unique token associated with the solution
    required int32 token = 2;
}

message PlanMAMsgSolutionAck {
    required int32 agent_id = 1;
    required bool ack = 2;
    required int32 token = 3;
}

message PlanMAMsgSolutionMark {
    required int32 agent_id = 1;
    required int32 token = 2;
}

message PlanMAMsgTerminateRequest {
    required int32 agent_id = 1;
}

message PlanMAMsg {
    enum Type {
        TERMINATE         = 0x0101;
        TERMINATE_REQUEST = 0x0102;

        TRACE_PATH = 0x0201;

        SEARCH_PUBLIC_STATE = 0x0401;

        HEUR_REQUEST  = 0x0801;
        HEUR_RESPONSE = 0x0802;

        SOLUTION      = 0x1001;
        SOLUTION_ACK  = 0x1002;
        SOLUTION_MARK = 0x1003;
    }

    required Type type = 1;

    optional PlanMAMsgPublicState public_state = 2;
    optional PlanMAMsgTracePath trace_path = 3;
    optional PlanMAMsgHeurRequest heur_request = 4;
    optional PlanMAMsgHeurResponse heur_response = 5;
    optional PlanMAMsgSolution solution = 6;
    optional PlanMAMsgSolutionAck solution_ack = 7;
    optional PlanMAMsgSolutionMark solution_mark = 8;
    optional PlanMAMsgTerminateRequest terminate_request = 9;
}
